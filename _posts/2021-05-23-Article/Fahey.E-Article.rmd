---
title: "Brief Title"
description: |
  Article Actual title will go here.
author:
  - name: Emma Fahey
date: "06/04/2021"
output:
  distill::distill_article:
    self_contained: false
bibliography: references.bib
---

```{r setup, include=FALSE}

# this code can be used for each chunk where applicable 
# code does or doesn’t display inline (echo setting)
# figures are shown at various sizes (fig.width and fig.height settings)
# warnings and messages are suppressed (warning and message settings)
# computations are cached (cache setting)

knitr::opts_chunk$set(fig.width=8, fig.height=5, 
               echo=TRUE, 
               warning=FALSE, message=FALSE, 
               cache=TRUE)

```

```{r libraries and import, include=FALSE}

#Libraries  
library(gendercoder)
library(rstan)
library(readr)
library(dplyr)
library(table1)

# rstan options
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores ())
theme_set(theme_classic())

# read/import data
df <- read_csv("processed_nature.csv") # reading the data. 

df$gender_code <- gendercoder::recode_gender(df$gender) # making the gender codes uniform as were free text entries. 

df <- mutate(df, age_clean = if_else(age < 1000, age, 2021 - age)) # cleaning age variable to remove extreme outliers. 

# reverse coding an item from the happiness scale 
df[,"shs_4_1"] <- lapply(df[,"shs_4_1" ], function(x){car::recode(x,"1 = 7; 2 = 6; 3 = 5; 4 = 4; 5 = 3; 6 = 2; 7 = 1")})

# create 3x new columns for motivation variable (as scale split in 3)
df$motsad <- (df[c("importance_1", "importance_2", "importance_3", "importance_4", "importance_5", "importance_6", "importance_7")])

df$mothap <- (df[c("importance_8", "importance_9", "importance_10", "importance_11")])

df$motref <- (df[c("importance_12", "importance_12", "importance_13", "importance_14")])

# generating mean scores for the scales. 
df$motsad <- rowMeans(df[paste0("importance_", 1:7)], na.rm = T)
df$mothap <- rowMeans(df[paste0("importance_", 8:11)], na.rm = T)
df$motref <- rowMeans(df[paste0("importance_", 12:14)], na.rm = T)
df$swls <- rowMeans(df[paste0("swl_", 1:5)], na.rm = T) 
df$shs <- rowMeans(df[paste0("shs_", 1:4, "_1")], na.rm = T) 

mean(df$age_clean, na.rm = T)

```

## Introduction

If I were to tell you to think of a meaningful place right now, would one come to mind? In most cases, the answer to this question would be yes. It is believed that we have an innate connection to certain places, this is defined as topophilia and has been studied for many years [@tuan1990]. Places, particularly natural ones, are known to have restorative psychological effects when visited [@ratcliffe2018; @scannell2017; @ulrich1981]. It is thought that people imbue environments with meaning arising from their current needs and wellbeing [@kerr1999]. Favourite or meaningful places have been studied as a way of environmental self-regulation, a coping mechanism to enhance subjective wellbeing and promote emotional regulation [@korpela1992; @korpela2010].

These ideas have been taken a step further by looking at illicit emotional responses in the brain in reaction to meaningful places, providing evidence that meaningful places are unique as our brains process images of them differently to other places [@gatersleben2020; @lengen2012]. With places becoming restricted or forbidden during COVID-19, it is an important time to measure how our use of meaningful places might be affecting our wellbeing. Findings of quality of life decreasing during COVID-19 if no emotion regulation was occurring [@panayiotou2021] furthers this point. Emotion dysregulation has also been found to predict greater acute COVID-19 stress and is a vulnerability factor to poor stress responses [@tyra2021].

Life satisfaction and happiness are frequently studied together worldwide. The two terms have been used under the heading of subjective wellbeing [@selim2008] and hedonic wellbeing [@difabio2015; @kahneman1999]. Studies include measures of cultural variation, [@bastian2014] in relation to suicide rates [@bray2006], in relation to physical health in elderly populations [@lara2020], in relation to wellbeing trends as populations age [@an2020], and more recently in response to the COVID-19 pandemic [@bozkurt2021]. Happiness in particular is rated as an important characteristic for subjective wellbeing, with college students in one study rating it on average 8.1 out of 9 for importance, compared to other wellbeing characteristics [@kim-prieto2005].

The current study looks at life satisfaction and happiness scores in relation to the importance or motivation to visit a meaningful place. Importance is split up into three subcategories: happy, sad, and reflective reasons to visit a place. The question is if reasons to visit a meaningful place predict subjective wellbeing. Hypotheses include (1) the motivation to visit a meaningful place in a positive mood will relate to higher subjective wellbeing scores. Conversely, if visiting for a negative reason I expect overall subjective wellbeing to be lower. (2) Consistent with Korpela et al. (2020), life satisfaction will be positively associated with sad and happy reasons to visit a place, but not reflective reasons.

## Method

**Participants** (n = 303) were recruited through an undergraduate introduction to psychology course at Victoria University, Wellington, New Zealand. Participants were awarded course credit for taking part in the study. The mean age of participants was 19.45 (SD = 4.46, Min = 17, Max = 69). The majority of participants were female (245, 80.8%), followed by male (47, 15.5%) and non-binary (1%), 8 participants did not supply a gender (2.6%). One outlier was removed from the data set for having an age over 1000.  

**Procedure.** Participants took part in the survey online through Qualtrics. The survey was broken into two sections. Part one contained the upload of a meaningful image to the participant. This was followed by open-field questions to determine the meaning of the place and two scales to determine the places importance and situational meaning. The second part of the survey included self-measures for nature connectedness and a variety of wellbeing measures. The survey took approximately 30 minutes to complete, and participants could withdraw at any time. Only the three scales described below will be used in the current report.   

### Materials

**Happiness** was measured by the measure of subjective happiness scale [@lyubomirsky1999]. This scale consists of 4 items that are rated between 1 and 7. Values of the scale differed for each question. The following statement was provided before commencement "For each of the following statements and/or questions, please select the point on the scale that you feel is most appropriate in describing you." A mean happiness score for each participant was calculated by summing all items.

**Life Satisfaction** was assessed using the Satisfaction with Life Scale (SWLS) [@diener1985]. Participants responded to a likert 7-point scale. The items were preceded by the statement: "Below are five statements that you may agree or disagree with. Using the 1 -- 7 scale below indicate your agreement with each item. Please be open and honest in your responding." The scale ranged from 1(strongly disagree) to 7(strongly agree). A mean life satisfaction score for each participant was created by summing all items.

**Reasons to visit a place.** An amended version of the importance of places scale [@korpela2020] was administered to participants to assess the reasons that place was visited. Participants responded on a likert 7-point scale which ranged from 1 (not at all) to 7 (very important). Due to initial confirmatory factor analysis results from @korpela2020, we amended the scale from 19 items down to 13. We then added the item "when wanting to meditate" to the alone or reflective category. The final 14-item scale was prefaced with the statement: "How important are the following situations as reasons to visit the place in the photo?" These reasons create three subfactors: Happy or well (4-items), alone or reflective (3-items), and sad or depressed (7-items.) The full scale can be found in the appendix. Items were grouped into the above categories and a sum score was calculated for each category.

**Scale Statistics**

The spread of responses to each scale are shown in figure \@ref(fig:plots). This allows us to check if scale distribution is normal to fit the assumptions of the structural equation model.  

```{r descriptives, include=FALSE}

# select the variables needed 
df2 <- df %>%
  select(gender_code, age_clean, swl_1, swl_2, swl_3, swl_4, swl_5, swls, shs_1_1, shs_2_1, shs_3_1, shs_4_1, shs, motsad, mothap, motref)
head(df2) # checking the variables 

# table - code for descriptive stats of the scales (means etc.) 
table1::label(df$swls) <- "Life Satisfaction"
table1::label(df$shs) <- "Happiness"
table1::label(df$mothap) <- "Happy Motivation"
table1::label(df$motsad) <- "Sad Motivation"
table1::label(df$motref) <- "Reflective Motivation"

# actual table 
table1::table1(~ swls + shs + mothap + motsad + motref, data = df2)

# histograms - desriptive graphs to show distribution of the data 
p1 <-
  qplot(df$swls, geom = "histogram") + labs(title = "Life Satisfaction") + xlab("swls")
p2 <-
  qplot(df$shs, geom = "histogram") + labs(title = "Happiness") + xlab("shs")
p3 <- 
  qplot(df$mothap, geom = "histogram") + labs(title = "Happy Motivation") + xlab("mothap")
p4 <- 
  qplot(df$motsad, geom = "histogram") + labs(title = "Sad Motivation") + xlab("motsad")
p5 <- 
  qplot(df$motref, geom = "histogram") + labs(title = "Reflective Motivation") + xlab("motref")

p1 + p2 + p3 + p4 + p5

```

```{r plots, echo=FALSE, fig.cap= "Distribution of Scales"}
plot(p1 + p2 + p3 + p4 + p5)
```

```{r reliabilities, include=FALSE}

# alpha reliability calculation 
print(psych::alpha(df2[paste0("swl_", 1:5)]))
print(psych::alpha(df2[paste0("shs_", 1:4, "_1")]))
print(psych::alpha(df[paste0("importance_", 1:7)]))
print(psych::alpha(df[paste0("importance_", 8:11)]))
print(psych::alpha(df[paste0("importance_", 12:14)]))

# other reliability calculation 
print(ufs::scaleStructure(df2[paste0("swl_", 1:5)]))
print(ufs::scaleStructure(df2[paste0("shs_", 1:4, "_1")]))
print(ufs::scaleStructure(df[paste0("importance_", 1:7)]))
print(ufs::scaleStructure(df[paste0("importance_", 8:11)]))
print(ufs::scaleStructure(df[paste0("importance_", 12:14)]))

# these have been added to the apa format table in the code chunk below. 

```

The main descriptive statistics for each scale can be found in table 1.  

```{r, echo=FALSE, results='asis'}

# Create table data for apa format 

tab_01 = data.frame(
  scale = c("SHS", "SWLS", "MotHap", "MotSad", "MotRef"),
  Mean = c("4.27 (0.76)", "4.49 (1.27)", "5.13 (1.56)", 
           "4.04 (1.69)", "4.73 (1.82)"),
  Alpha = c("0.87", "0.84", "0.90", "0.94", "0.82"),
  Omega = c("0.89", "0.88", "0.92", "0.96", "0.83"), 
  Coefficient_H = c("0.88", "0.87", "0.94", "0.95", "0.85")
)

library(kableExtra)

# apa format of a table 

kable(
  tab_01,
  format = "html",
  booktabs = TRUE,
  escape = FALSE,
  longtable = TRUE,
  col.names = c("Scale", "Mean(SD)", "Alpha", "Omega", "Coefficient_H"),
  align = c("l", "c", "c", "c", "c"),
  caption = "Means, Standard Deviations and reliabilities of Scales"
  ) %>%
  row_spec(row = 0, align = "c") %>%
  kable_styling(full_width = TRUE) %>%
  footnote(
    general_title = "Note.",
    general = "Standard deviations are in parentheses. SHS = Subjective Happiness Scale; SWLS = Satisfaction with Life Sacle; MotHap = Happy Motivation Scale; MotSad = Sad Motivation Scale; Motref = Refletive Motivation Scale.",
    threeparttable = TRUE,
    footnote_as_chunk = TRUE
    )

```

The main descriptive statistics for each scale can be found in table 1. Multiple reliability tests were run to determine the scales alpha, omega and coefficient H. This is because the alpha reliability alone assumes scales are uni-dimensional and normally distributed. Items in each reasons to visit a place subscale were not shown to be normally distributed in figure \@ref(fig:plots) above.

The initial use of the reasons to visit a place scale had comparable reliability, with cronbach's alpha being reported as 0.93 for sad motivation, 0.87 for happy motivation and 0.8 for alone motivation subscales [@korpela2020].  

### Networks

A network graph, shown in figure \@ref(fig:net1) is used to display the connectedness of the scales used in the current study. As expected, life satisfaction and happiness form a connection. The three subscales of reasons to visit a place form a strong connection.  

```{r net1, echo=FALSE, fig.cap= "Network Graph"}
# creating a network map of scale items 
network1 <- bootnet::estimateNetwork(select(df2, -age_clean, -gender_code, -shs, -swls), "EBICglasso")
owl <- qgraph::qgraph(network1$graph, layout = "spring")
# the above shows that happiness and life satisfaction form a connection. 

```

The exploratory graph analysis in figure \@ref(fig:networks) shows that life satisfaction and happiness are still separate constructs, but that the three subscales of reasons to visit a place may be measuring only one construct. To ensure the new reasons to visit a place subscale were measuring three separate constructs, a second exploratory graph analysis is run (see appendix \@ref(fig:appen1)). This shows that the subscales are connected, yet independent constructs. A network graph is also run for the new subscales to ensure that items selected to mean happy, sad, and reflective are most connected to each other. This was found to be accurate (see appendix \@ref(fig:appen2)).

```{r networks, echo=FALSE, fig.cap= "EGA Graph"}

ega <- EGAnet::bootEGA(select(df2, -age_clean, -gender_code, -shs, -swls), iter = 1000)

# the above shows us that life satisfaction and happiness are independent constructs. 

```

### Correlation Analysis

Figure \@ref(fig:corr) depicts correlations between scales. All correlations are run with Holm adjustment, this reduces the possiblilty of a statistically significant result, or type 1 error when performing multiple tests. This correction is more statistically powerful than a Bonferroni adjustment (ADD CITE ONCE SYNCHED).

```{r corr, echo=FALSE, fig.cap= "Correlation Plot of Scales"}

ggstatsplot::ggcorrmat(df, c("age_clean", "swls", "shs", "motsad", "mothap", "motref"), 
                       cor.vars.names = c("age", "Life Satisfaction", "Happiness", "Sad Motivation", "Happy Motivation", "Reflective Motivation"))

```

Life satisfaction and happiness correlate significantly. All three reasons for visiting a place correlate, with reflective and sad being the strongest. These results are comparable with those of @korpela2020 that found sad and reflective to correlate at 0.68, sad and happy to correlate at 0.32, and reflective and happy to correlate 0.35.   

### Model Selection

```{r modsel, echo=FALSE, fig.cap= "Structural Equation Model"}

# path model of the equation
semPaths(sem_res_strap, layout = "tree") 

```

A structural equation model (figure \@ref(fig:modsel)) is run in this study to analyse reasons to visit a meaningful place against life satisfaction and happiness. The (ML) is employed, which presumes multivariate normality of the variables. As stated previously and depicted in figure \@ref(fig:plots), the motivations to visit a place subscales were not normally distributed, so a bootstrap adjustment was fitted to the model. This runs the same analysis 1,000 times to get an average which creates more reliable and robust results, particularly when considering non-normality.  

## Results




```{r basic model code, include=FALSE}
library(lavaan)

# SEM to test hypoth

mdl_sem <- 'swls ~ motsad + mothap + motref
	shs ~ motsad + mothap + motref' # this is the model 

sem_res_strap <- sem(mdl_sem, df2, se = "bootstrap", estimator = "ML")  # this is running a bootstrap version of the above model. 

summary(sem_res_strap, standardize = T, fit = T) #this reports the model in a readable format  


# second one - this sees if the model differs per gender. 
	
sem_res_1 <- sem(mdl_sem, filter(df2, gender_code %in% c("male", "female")), estimator = "ML", group = "gender_code", se = "bootstrap") 
sem_res_mtr <- sem(mdl_sem, filter(df2, gender_code %in% c("male", "female")), estimator = "ML", group = "gender_code", group.equal = "regressions", se = "bootstrap")
# MLR uses approx to multuvariate data and using scaling factor to adjust qui-squared. Like a students t-test. But instead we using ML (the norm), and bootstrap. This runs the analysis 1000 times to get an average answer. 


summary(sem_res_1, standardize = T, fit = T) 
summary(sem_res_mtr, standardize = T, fit = T)
# once generated these, we looking at the cfi - the differences. 

# Bootstrapping randomly grabs part of your data and makes a new average. Allows confidence intervals. 

# from this 2x sig (mothap and shs in both). 


```

Results are depicted in figure \@ref(fig:resdep)


```{r resdep, echo=FALSE, fig.cap= "Structural Equation Path Model with Results"}


# add to results - to interpret!! 
semPlot::semPaths(sem_res_strap, "std",
                  layout = "spring",
                  exoVar = FALSE,
                  exoCov = FALSE,
                  sizeMan = 15, sizeInt = 15, sizeLat = 15,
                  edge.label.cex=1.5,
                  fade=FALSE)

# std is standard estimates, can also use "par" which would report unstandardised estimates 
# can see that positively are mothap and motref, but neg is motsad, that's good!!!

# the findigs are shown in the below correlation plot. # unsure if needed, Maybe in appendix. 
# semPlot::semCors(sem_res_strap, include = "observed")



```

## Discussion

Enter here.

### Limitations and Future Research

Enter here from word.


## Appendix

Scales

Figure play: A distribution of the scales is shown in figure \@ref(fig:appen1)

```{r appen1, echo=FALSE, fig.cap= "Subscale EGA"}

library(dplyr)

df10 <- df %>%
  select(age_clean, gender_code, importance_1, importance_2, importance_3, importance_4, importance_5, importance_6, importance_7, importance_8, importance_9, importance_10, importance_11, importance_12, importance_13, importance_14, motsad, mothap, motref)

ega3 <- EGAnet::bootEGA(select(df10, -age_clean, -gender_code, -motsad, -mothap, -motref), iter = 1000)
# the above shows us that there are 3 clear independent constructs for motivation.  

```

```{r appen2, echo=FALSE, fig.cap= "Subscale Network Graph"}

# creating a network map of scale items 
network3 <- bootnet::estimateNetwork(select(df10, -age_clean, -gender_code, -motsad, -mothap, -motref), "EBICglasso")
owl <- qgraph::qgraph(network3$graph, layout = "spring")
 

```



### R Packages used:

```{r references, echo=FALSE}

# content for the package references 
report::cite_packages()

```

## References